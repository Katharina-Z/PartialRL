
using CSV
using DataFrames
using DataFramesMeta

data = CSV.read("/Users/katharinazuehlsdorff/PartialRL/Animal1.csv", copycols=true)
select!(data, Not(1:3))
rename!(data, [:CR, :CN, :Prem, :Omissions, :Incorrect, :RespLat, :CollLat])


#=
Possible actions:
Nose poke to light & receive reward (NPR = 1)
Nose pose to light, correct & no reward (NPNR = 2)
Nose poke to light but incorrect, no reward (NPiNR = 3)
Nose poke to light but premature, no reward (NPpNR)
Omission (O = 5)
=#

#The value in the sequence will be 1 when
#data.Sequence = 0
#data[data[!, :CR] .== 1,:Sequence] .= Ref(1)
#data[data[!,:CN] .== 1,:Sequence] .= Ref(2)
#data[data[!, :Prem] .== 1,:Sequence] .= Ref(3)
#data[data[!, :Incorrect] .== 1,:Sequence] .= Ref(4)
#data[data[!, :Omissions] .== 1,:Sequence] .= Ref(5)

#response latency for omisssion not included
#if collection latency 0, interpret as NaN
#exclude collection latencies for premature, omissions and incorrect

data.Tau = data.RespLat + data.CollLat


data.RewSum = 0

for (i,v) in enumerate(data.RewSum)
    data.RewSum[1] = 0
    if i > 1
        data.RewSum[i] = data.CR[i] + data.CR[i-1]
    end
end


data.TauSum = data.Tau

for (i,v) in enumerate(data.TauSum)
    if i > 1
        data.TauSum[i] = data.TauSum[i] + data.TauSum[i-1]
    end
end


RewSum = data.RewSum
TauSum = data.TauSum


module CleanData


export RewSum, TauSum

end
